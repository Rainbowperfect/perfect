
<template>
  <div class="pageNavVue" v-show="show">
    <ul class="pageNav">
      <li>
          <selected :list="myList" 
                    :value.sync="limit" 
                    :name="'num'"
                    :sign="'num'"
                    :placeholder="limit"
                    v-on:chose="changelimit">
          </selected>
      </li>

      <li :class="{'prohibit':current==1}"><a href="javascript:;" @click="goPage(current-1)" style="width:24px"><img src="../../assets/left2.png"></a></li>
      <li><a class="pageItem" href="javascript:;" 
             @click="goPage(1)"
             v-show="begin!==1">1..</a></li>
      
      <li v-for="(item,index) in diff" 
          :class="{'active':(index+begin)==current}"
          @click="goPage(index+begin)">
        <a class="pageItem" href="javascript:;">{{index+begin}}</a>
      </li>

      <li><a class="pageItem" href="javascript:;" 
             @click="goPage(pageCount)" 
             v-show="(end!=pageCount)">..{{pageCount}}</a></li>
      <li :class="{'prohibit':current==end}"><a href="javascript:;" @click="goPage(current+1)" style="width:24px"><img src="../../assets/right2.png"></a></li>
      <li>
          <a href="javascript:;">转至</a>
      </li>
      <li><input class="page_input" type="number" min="1"
                 v-model="inputPage" 
                 @keydown.13="turnPage">
      </li>
      <li>
          <input type="button" class="pageGo" @click="turnPage" value="GO">
      </li>
    </ul>
    <div class="pageNavTotal">总数：{{total}}</div>
  </div>
  
</template>

<script>
    export default{
        props:['list'],
        data(){
          return{
            myList:[],//每页数组
            limit:20,//每页数量
            offset:0,
            current:0,
            total:0,//总数
            pageCount:0,//总页数
            show:false,
            pageL:0,//页签数组
            begin:0,//开始页码
            end:0,//结束页码
            diff:0,//可见页码个数
            idx:0,//点击的页码
            inputPage:'',//输入页码
          }
        },
        computed:{          

        },
        methods:{
          //选择每页数量
          changelimit(){
            this.offset = 0;
            this.goPage();
          },
          //开始分页
          goPage(index){
            if(index<1 || index>this.pageCount){
              return;
            }
            index = index?index:1;
            this.idx =  index;
            this.offset = (index-1)*this.limit;
            this.$emit('goPage',this.offset,this.limit)
          },
          renderPage(count){
            if(count){
              this.show = true;
              this.total = count;
              this.pageCount = Math.ceil(count/this.limit);
              count = this.pageCount;
              var index = this.idx;
              var begin = index-2;
              var end = index+2;
              if (count<=5){
                  begin = 1;
                  end = count;
              }
              else if(end>count){
                  end = count;
                  begin = end-4;
              }else if(begin<1){
                  begin = 1;
                  end = begin+4;
              }
              this.begin = begin;
              this.end = end;
              this.diff = end-begin+1;
              this.current = this.idx;

            }else{
              this.show = false;
            }
          },
          turnPage(){
            var p = this.inputPage.trim()-0;
            if(p && p>0 && p<this.pageCount+1){
                this.goPage(p);
            }else{
                this.inputPage = '1';
            }
          }
        },
        created(){
          //初始化下拉框
          var arr = this.list?this.list:[20,50,100];
          var list = [];
          for(var i=0;i<arr.length;i++){
            var o = {};
            o.num = parseInt(arr[i]);
            list.push(o);
          }
          this.myList = list;
          this.limit =  this.myList[0].num;
        }
    }
</script>
<style>
  .pageNavVue{
    padding: 2px 0 2px 5px;
    width: 100%;
    
    height: 28px;
    /*border-bottom: 1px solid #c2c2c2;
    background: #eee;
    border-top: 1px solid #c2c2c2;*/
  }
  .pageNavVue>.pageNavTotal{
    font-size: 12px;
    color: #666;
    float: right;
    margin-right: 15px; 
    top: 5px;
    position: relative;
  }
  ul.pageNav{
    float: right;
  }
  .pageNav .Seledrop .sele-toggle{
    min-width: 42px;
    height: 24px;
    padding-left: 5px;
    line-height: 24px;
    color: #337ab7;
  }
  .pageNav .Seledrop .sele-menu>li{
    padding:2px 5px;
  }

  .pageNav .page_input{
      width: 45px;
      height: 24px;
      border-radius: 0;
      line-height: 24px;
      margin:0;
      padding: 0 0 0 2px;
      font-size:12px;
      min-width: 23px;
      max-width: 50px;
      border: 1px solid #ddd;
  }
  .pageNav .pageGo{
    display:  inline-block;
    height: 24px;
    width: 45px;
    font-size: 12px;
    text-align: center;
    border: 1px solid #ddd;
    background: none;
  }
  .pageNav>li{
      float: left;
      margin-left: 5px;
      color: #337ab7;
      background-color: #fff
      
  }
  .pageNav>li>a,
  .pageNav>li>span,
  .pageNav>li>select,
  .pageNav>li>input[number]
  {
    font-size: 12px;
      border: 1px solid #ddd;
      padding:0 5px;
      line-height: 22px;
      float: left;
  }
  .pageNav>li>select,
  .pageNav>li>input{
      outline:none;
       float: left;
  }
  .pageNav>li>select{
    height: 24px;
  }
  .pageItem{
      min-width: 30px;
      text-align: center;
  }
  .pageNav .active{
      background-color: #4597f1;;
  }
  .pageNav .active a{
      color: #fff;
  }
  .pageNav .Seledrop .sele-menu{
      min-width: 42px;
      margin: -1px 0 0 0px;
      padding: 0;
      border: 1px solid #ddd;
  }
  .pageNav .Seledrop .sele-menu li{
      height: 20px;
  }
  .pageNav .open.Seledrop>.sele-toggle.btn-default, 
  .pageNav .Seledrop .sele-toggle.btn-default:hover,
  .pageNav .Seledrop .sele-toggle.btn-default:focus{
       color: #337ab7; 
       background-color: #fff; 
       border-color: #ddd; 
       box-shadow: none;
  }
  .pageNav .Seledrop .sele-menu>li>a{
      padding: 0 0 0 5px;
      color: #337ab7;
  }
  .pageNav .Seledrop .sele-menu>li>a:hover{
      background-color: #4597f1;
      color: #fff;
  }
  .pageNav .btn-group button{
    border:1px solid #ddd;
    border-radius: 0;
    color: #337ab7;
    padding: 5px;
    margin: 0;
    letter-spacing: 0px;
  }
  .pageNav .caret{
    margin-left: 5px;
  }
  .pageNav li.prohibit{
    color: #999;
  }
  .pageNav li.prohibit a{
    color: #999;
  }
</style>
